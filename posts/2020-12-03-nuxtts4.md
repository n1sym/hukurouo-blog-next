---
title: nuxt-ts day4ï¼šaxiosã§ãƒ©ãƒ³ãƒ€ãƒ çŒ«ç”»åƒ
date: 2020-12-03
categories: æŠ€è¡“
tags: [advent]
toc_flg: true
---

4æ—¥ç›®ã€‚ä»Šæ—¥ã¯ axios ã‚’ãƒ¡ã‚¤ãƒ³ã«ã‚„ã£ãŸã€‚

![](https://firebasestorage.googleapis.com/v0/b/hukurouo.appspot.com/o/image%2Frapture_20201204001012.png?alt=media&token=59763a8a-b04f-4c7d-b57a-8da0fe01b930)

https://nuxt-ts-sample.netlify.app/axios

ãƒ©ãƒ³ãƒ€ãƒ ã§çŒ«ã®ç”»åƒãŒè¡¨ç¤ºã•ã‚Œã‚‹ãƒšãƒ¼ã‚¸ã‚’ä½œã‚Šã¾ã—ãŸã€‚

## typesãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å‹å®šç¾©ã‚’åˆ†é›¢

å‹å®šç¾©ã ã‘ã‚’å°‚ç”¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ç®¡ç†ã—ã¦ã¿ã‚‹ã€‚

ã“ã‚“ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã£ã¦ã€

~~~ts{}[types\user.ts]
export interface User {
  firstName: string
  lastName: string
}
~~~

ä»»æ„ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§èª­ã¿è¾¼ã‚€ã€‚

~~~ts{}[components\User.vue]
import { User } from '~/types/user'
~~~

ã“ã‚Œã§è¤‡æ•°å€‹æ‰€ã§ä½¿ã„ã¾ã‚ã›ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚è¦‹é€šã—ã‚‚è‰¯ããªã£ãŸæ°—ãŒã—ã¾ã™ã€‚

## nuxt_config.ts ã®è¨­å®š

config ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å‹å®šç¾©ã§ãã‚‹ã‚ˆã†ãªã®ã§ã‚„ã£ã¦ã¿ã‚‹ã€‚

ã“ã“ã®è¨˜è¿°ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ãªã©ã§çµæ§‹é »ç¹ã«å¤‰ã‚ã£ã¦ã„ã‚‹ã‚‰ã—ã„ã€‚éå»ã®è¨˜äº‹ã‚’æ¼ã£ã¦ã‚‹ã¨ä½•ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚ã£ãŸã€‚

~~~ts{}[nuxt.config.ts]
import { NuxtConfig } from '@nuxt/types'
const nuxtConfig: NuxtConfig = {
  ...
}
module.exports = nuxtConfig
~~~


## axiosã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹

axios ã§ã‚‚å‹ã‚’ä½¿ã„ãŸã„ã®ã§è‰²ã€…ã¨è¨­å®šã—ã¦ã„ãã¾ã™ã€‚

~~~bash
npm install @nuxtjs/axios
~~~

```ts{}[plugins\axios-accessor.ts]
import { Plugin } from '@nuxt/types'
import { initializeAxios } from '~/utils/api'

export const accessor: Plugin = ({ $axios }): void => {
  initializeAxios($axios)
}

export default accessor
```

~~~ts{}[utils\api.ts]
/* eslint-disable import/no-mutable-exports */
import { NuxtAxiosInstance } from '@nuxtjs/axios'

let $axios: NuxtAxiosInstance

export function initializeAxios (axiosInstance: NuxtAxiosInstance): void {
  $axios = axiosInstance
}

export { $axios }
~~~

~~~ts{}[nuxt.config.ts]
  plugins: [
    '@/plugins/composition-api',
    '@/plugins/axios-accessor'
  ],
~~~

ã“ã‚Œã§ã©ã“ã‹ã‚‰ã§ã‚‚ axios ãŒå‚ç…§ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

## axiosã§çŒ«ç”»åƒã‚’å–å¾—ã™ã‚‹

`https://aws.random.cat/meow`

ã“ã®APIã‚’å‘¼ã³å‡ºã—ã¦ã€çŒ«ç”»åƒã‚’å–å¾—ã—ã¦ã¿ã¾ã™ã€‚

~~~ts{}[pages\axios.vue]
<template>
  <div class="justify-center items-center text-center mx-auto">
    <h1>randomCat (axios)</h1>
    <button class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded" @click="changeCat">
      change ğŸ±
    </button>
    <br><br>
    <img :src="state.cat_url" alt="">
  </div>
</template>

<script lang="ts">
import { onMounted, defineComponent, reactive } from '@vue/composition-api'
import { $axios } from '~/utils/api'

export default defineComponent({
  setup () {
    const state = reactive({
      cat_url: '' as string
    })
    const asyncFunc = async (): Promise<void> => {
      const CatObj: {file: string} = await $axios.$get('https://aws.random.cat/meow')
      state.cat_url = CatObj.file
    }
    const changeCat = () => { asyncFunc() }

    onMounted(() => { asyncFunc() })

    return {
      state, changeCat
    }
  }
})
</script>
~~~

ä»Šæ—¥ã¯ã“ã“ã¾ã§ã€‚